define(["domReady","v"],function(e,t){var n=Backbone.View.extend({render:function(){var e=this,n=["sun","mon","tue","wed","thu","fri","sat"],r={t:2,b:2,l:35,r:0},i=t.barSize,s=t.cellSize*7,o=d3.scale.linear().range([0,i]).domain([0,this.collection.max]),u=d3.scale.ordinal().rangeBands([0,s],.2,0).domain(d3.range(7)),a=d3.select(this.el).attr({width:i+r.l+r.r,height:s+r.t+r.b}),f=a.append("g").attr({transform:"translate("+r.l+","+r.t+")"}),l=f.selectAll(".bars").data(this.model.get("dow")).enter().append("rect").attr({"class":"bars",x:0,y:function(e){return e.key*t.cellSize+.1*t.cellSize},height:t.cellSize-.2*t.cellSize,width:0}).style({fill:function(e){return t.color(e.value)}});l.on("mouseover",function(r){e.trigger("tooltip",!0,this,{steps:r.value,text:"average"}),d3.select(this).attr("class","linkColor").style("fill","");var i=d3.select(this.parentNode.parentNode.parentNode.parentNode).select(".svgCalendar g"),s={"class":"dayHover",width:t.cellSize*53,height:t.cellSize,y:r.key*t.cellSize,x:0};i.append("rect").attr(s).style({fill:"gray",stroke:"none","stroke-width":4,"pointer-events":"none",opacity:.5}),i.append("rect").attr(s).style({fill:"none",stroke:"none","stroke-width":2,"pointer-events":"none"})}),l.on("mouseout",function(n){d3.selectAll(".dayHover").remove(),d3.select(this).attr("class","").style("fill",function(e){return t.color(e.value)}),e.trigger("tooltip",!1)}),l.transition().delay(265).attr({width:function(e){return o(e.value)}}),f.append("path").attr({d:"M0,0v"+s,"class":"whiteLine"}),f.append("path").attr({d:"M0,0v"+s,"class":"blackLine"}),f.selectAll("weekLabel1").data(this.model.get("dow")).enter().append("text").attr({x:-r.l*.65,y:function(e,n){return n*t.cellSize+t.cellSize/2},"text-anchor":"middle",dy:".35em"}).text(function(e,t){return n[t]})}});return n});